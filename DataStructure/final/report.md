## 一. 需求分析

1. 对城市列表, 列车时刻表和航班时刻表提供两种输入方式, 分别是由用户交互式输入和由文本文件导入, 文本文件的格式参见输入输出实现部分. 
1. 城市定义: 以城市拼音名称字符串来代表城市. 对于用户输入的数据, 要求不同的城市所对应的拼音名称不同.
1. 列车/航班时刻表说明: 考虑列车发车的真实时间(包括日期), 注意列车和航班并不是每天都有的, 可能是按周次开行或者是某一天的临时列车/航班. 算法提供对各种不同类型的支持. 对于一次列车/航班, 有效的数据包括: 列车/航班号, 出发地, 到达地, 出发时间, 到达时间, 价格. 其中列车号/航班号不会重复.
1. 输出结果: 提供保存当前城市列表, 保存当前列车/航班列表功能. 提供由用户交互式输入需求生成最优路线设计的功能. 输出的最优路线包括其中用到的所有列车/航班的详细信息.
1. 测试数据1: 人为构造的包含各种特殊情况的数据集, 测试数据2: 来自携程的真实数据集. 

## 二. 概要设计

整体算法如下: 使用键树实现城市名称字符串向城市的数据表示的映射. 使用邻接表来保存全国交通图. 使用迪杰特斯拉最短路径算法及其优化(最优时间/价格), 洪水算法(最少换乘)实现路径设计. 使用正则匹配从html文件中自动获取交通信息.

程序分为以下几个部分:

数据结构定义
    城市顶点定义
    时间信息定义
    列车信息定义
    交通图(有向图)结构定义
输入输出函数
    文件读写函数定义
    交互式输入输出定义
最优路径算法
    适用于最短时间的算法
    适用于价格最低的算法
    适用于换乘次数最少的算法
配套服务函数
    从携程获取飞机/火车信息的程序


涉及的抽象数据类型如下:

1. 定义时间类型, 用于表示列车/飞机出发及到达的时间

```cpp

class Time
{
  public:

    //数据对象: 列车/航班出到站的时间 T:={时间类型,(日期),小时,分钟};
    int type_;//数据类型, 可以为"每日"类型, 用于存储每天重复的列车信息. 也可以为"给定日期"类型, 用于存储算法进行中的时间以及只在指定日期发车的列车信息
    int day_;//日
    int hour_;//小时
    int min_;//分钟
    
    //数据关系:
    //时间比较操作
    bool operator<(Time& b);
    bool operator>(Time& b);
    //比较两个时间, 判断时间1和2"可能"的前后关系是否存在.
    //特殊比较规则: 只进行两个"含日期"的时间相比较.
    
    //基本操作:
    //设置时间信息
    Time();
    Time(int hour, int min);
    Time(weekdays day, int hour, int min);
    //初始条件: 输入如函数的输入参数所示
    //操作结果: 初始化时间结构, 并按照输入参数设置时间类型

    //从已有的时间为时间结构赋值(复制构造函数)
    Time(const Time &src);
    Time operator=(const Time &src);
    //初始条件: 输入如函数的输入参数所示
    //操作结果: 初始化时间结构, 并按照输入参数设置时间类型
    //直接复制源节点的时间信息

    //时间加减操作
    //计算两个时间点间的时间差
    int operator-(Time &b); //return the gap between two time points
    //计算一个时间点经过一段时间之后所到达的时间点
    Time operator+(int b);
    //初始条件: 见函数参数, int类型的时间间隔单位

    void print();

    friend ostream &operator<<(ostream &out, Time &time);
    friend istream &operator>>(istream &in, Time &time);
    
    int interactive_input();
};
```